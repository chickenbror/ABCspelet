{"ast":null,"code":"import _slicedToArray from\"C:/CodingProjects/ABCspelet/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"C:/CodingProjects/ABCspelet/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import*as React from\"react\";//XState library & Game DM-machine\nimport{Machine,assign,send}from\"xstate\";import{useMachine,asEffect}from\"@xstate/react\";import{dmMachine}from'./dmGame';//Animation effects\nimport Confetti from'react-dom-confetti';import TextLoop from\"react-text-loop\";import{useWindupString}from\"windups\";// import HeadShake from 'react-reveal/HeadShake';\nvar HeadShake=require('react-reveal/HeadShake');//?import shows error in TS, so use require() here instead\nvar RubberBand=require('react-reveal/RubberBand');import Tippy from'@tippyjs/react';// import 'tippy.js/dist/tippy.css'; \n//Browser detection \nimport{isChrome,isEdge}from\"react-device-detect\";// import { inspect } from \"@xstate/inspect\";\n// inspect({ url:\"https://statecharts.io/inspect\", iframe: false });\n// State machines: ASR-TTS (voice interface) & dmGame\nimport{useSpeechSynthesis,useSpeechRecognition}from'react-speech-kit';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var machine=Machine({id:'root',type:'parallel',states:{dm:_objectSpread({},dmMachine),asrtts:{initial:'idle',states:{idle:{on:{LISTEN:'recognising',SPEAK:{target:'speaking',actions:assign(function(_context,event){return{ttsAgenda:event.value};})}}},recognising:{initial:'progress',entry:'recStart',exit:'recStop',on:{ASRRESULT:{actions:['recLogResult',assign(function(_context,event){return{recResult:event.value};})],target:'.match'},RECOGNISED:'idle'},states:{progress:{},match:{entry:send('RECOGNISED')}}},speaking:{entry:'ttsStart',on:{ENDSPEECH:'idle'}}}}}},{actions:{recLogResult:function recLogResult(context){/* context.recResult = event.recResult; */console.log('<< ASR: '+context.recResult);},test:function test(){console.log('test');},logIntent:function logIntent(context){/* context.nluData = event.data */console.log('<< NLU intent: '+context.nluData.intent.name);}}});//COMPONENT: Big button in the middle, with changing texts\nvar ReactiveButton=function ReactiveButton(props){var playingNow=props.state.context.playingNow;var ttsAgenda=props.state.context.ttsAgenda;var maxHinted=props.state.context.hinted>=5;var maxSkipped=props.state.context.skipped>=5;var promptInGame;if(maxSkipped&&maxHinted){promptInGame='...eller s√§g Starta om, Sluta';}else if(maxSkipped&&!maxHinted){promptInGame='...eller s√§g Tips, Starta om, Sluta';}else if(!maxSkipped&&maxHinted){promptInGame='...eller s√§g Pass, Starta om, Sluta';}else{promptInGame='...eller s√§g Tips, Pass, Starta om, Sluta';}//default\nvar speakingText=playingNow?'üòº '+ttsAgenda:'üòª '+ttsAgenda;var promptMsg=playingNow?promptInGame:\"...s√§g Ja eller Nej\";switch(true){case props.state.matches({asrtts:'recognising'}):return/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\",style:{animation:\"glowing 20s linear\"}},props),{},{children:/*#__PURE__*/_jsxs(TextLoop,{mask:true,interval:5000,springConfig:{stiffness:170,damping:8},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"code\",{children:[\" \",speakingText,\" \"]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"code\",{children:[\" \",promptMsg,\" \"]})})]})}));case props.state.matches({asrtts:'speaking'}):var _useWindupString=useWindupString(speakingText),_useWindupString2=_slicedToArray(_useWindupString,1),spokentext=_useWindupString2[0];// adds char-by-char animation\nreturn/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\",style:{animation:\"bordering 1s infinite\"}},props),{},{children:/*#__PURE__*/_jsx(\"code\",{children:spokentext})}));default:return/*#__PURE__*/_jsx(\"button\",_objectSpread(_objectSpread({type:\"button\",className:\"glow-on-hover\"},props),{},{children:/*#__PURE__*/_jsx(HeadShake,{children:\"Spela nu!\"})}));}};// //MAIN CONTAINER: React webpage elements & VOI\nexport default function App(){//Voice interface events (& console logs)\n//Text to speech:\nvar _useSpeechSynthesis=useSpeechSynthesis({onEnd:function onEnd(){send('ENDSPEECH');}}),speak=_useSpeechSynthesis.speak,cancel=_useSpeechSynthesis.cancel,speaking=_useSpeechSynthesis.speaking,voices=_useSpeechSynthesis.voices;//Speech to text\nvar _useSpeechRecognition=useSpeechRecognition({onResult:function onResult(result){send({type:\"ASRRESULT\",value:result});}}),listen=_useSpeechRecognition.listen,listening=_useSpeechRecognition.listening,stop=_useSpeechRecognition.stop;//List the supported synthesis-voices on the browswer:\nvar _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),voiceIndex=_React$useState2[0],setVoiceIndex=_React$useState2[1];console.log(voices);//An array of available voices/languages ... varies depending on the computer/browser\nvar voice=voices[2]||null;// voices[idx]? voices[idx] : null *(browser default voice) //chrome on Mac:2, edge:8 bengt, edgeDev:32 bengt \nvar _useMachine=useMachine(machine,{devTools:true,actions:{recStart:asEffect(function(){console.log('Ready to receive a voice input.');listen({interimResults:false,continuous:true,lang:'sv-SE'//Config ASR input language here. //list of langs https://cloud.google.com/speech-to-text/docs/languages\n});}),recStop:asEffect(function(){console.log('Recognition stopped.');stop();}),ttsStart:asEffect(function(context,effect){console.log('Speaking...');speak({text:context.ttsAgenda,voice:voice//Config of TTS output language/voice\n});}),ttsCancel:asEffect(function(context,effect){console.log('TTS STOP...');cancel();}),speak:asEffect(function(context){console.log('Speaking...');speak({text:context.ttsAgenda});})}}),_useMachine2=_slicedToArray(_useMachine,3),current=_useMachine2[0],send=_useMachine2[1],service=_useMachine2[2];// dmMachine-context / React-states, to display on webpage or turn components on/off\nvar confettiSwitch=current.context.confettiSwitch;//triggers confetti when true\nvar playingNow=current.context.playingNow;var tally=current.context.tally;var letter=current.context.letter;// Config for confetti \nvar confettiConfig={angle:90,spread:360,startVelocity:80,elementCount:400,dragFriction:0.12,duration:7500,stagger:1,width:\"7px\",height:\"7px\",perspective:\"210px\",colors:[\"#a864fd\",\"#29cdff\",\"#78ff44\",\"#ff718d\",\"#fdff6a\"]};var clicked=0;var handleClick=function handleClick(){if(clicked===0){console.log(\"clicked\");send('CLICK');clicked=1;}else{console.log(\"unclicked\");send('UNCLICK');clicked=0;}};//>>>JSX codes & various components\n// Alt page: Show if not using Chrome or Edge\nif(!isChrome&&!isEdge)return/*#__PURE__*/_jsx(\"div\",{className:\"OtherBrowsers\",children:/*#__PURE__*/_jsx(HeadShake,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Box\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Din webbl\\xE4sare st\\xF6der inte taligenk\\xE4nning \\uD83E\\uDD72 \"}),/*#__PURE__*/_jsx(\"p\",{children:\"Anv\\xE4nd ist\\xE4llet Chrome eller Edge :-)\"})]})})});//Show if using Chrome or Edge\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"PopoverButtons\",children:[\" \",/*#__PURE__*/_jsx(PopoverButtons,{}),\" \"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"LetterAndHeart\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"GlowLetter\",children:[\" \",/*#__PURE__*/_jsx(YourLetter,{letter:letter}),\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"Heart\",children:playingNow&&/*#__PURE__*/_jsx(HeartBar,{currentScore:tally,maxScore:5,size:50})})]}),/*#__PURE__*/_jsx(Confetti,{active:confettiSwitch,config:confettiConfig}),/*#__PURE__*/_jsx(RubberBand,{children:/*#__PURE__*/_jsx(\"div\",{className:\"Button\",children:/*#__PURE__*/_jsx(ReactiveButton,{state:current,onClick:function onClick(){handleClick();}})})}),/*#__PURE__*/_jsx(\"div\",{className:\"Subtitles\",children:/*#__PURE__*/_jsx(UserSubtitles,{state:current})})]})]});};//COMPONENT: Displaying input of voice interface (ie, recResult)\nvar YourSubtitles=function YourSubtitles(props){// Player's speech-- only displays when recResult!=undefined \nvar tally=props.state.context.tally;var recResult=props.state.context.recResult;//Prefix face changes based on score of the game\nvar emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥'];var emoji=tally?emojis[tally]:'üôÉ';var subtitlesText;if(props.state.matches({asrtts:'recognising'})){subtitlesText=emoji+' Lyssnar nu p√• dig...';}else if(recResult&&recResult!=''){subtitlesText=emoji+' '+recResult;}else{subtitlesText='';}var _useWindupString3=useWindupString(subtitlesText),_useWindupString4=_slicedToArray(_useWindupString3,1),textAnimated=_useWindupString4[0];return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{children:[\" \",textAnimated,\" \"]})});};//This one doesn't show on Github pages...? but can run locally and use for presentation demo\nvar UserSubtitles=function UserSubtitles(props){var tally=props.state.context.tally;var recResult=props.state.context.recResult;// const recResult='testing text'\nvar emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥'];var emoji=tally?emojis[tally]:'üôÉ';// const defaultText = props.state.matches({ asrtts: 'recognising' })? 'Listening...' : ''\n// const subtitlesText = recResult? recResult : defaultText\nvar subtitlesText;if(props.state.matches({asrtts:'recognising'})){subtitlesText='Lyssnar nu p√• dig...';}else if(recResult&&recResult!=''){subtitlesText=recResult;}else{subtitlesText='';}var _useWindupString5=useWindupString(subtitlesText),_useWindupString6=_slicedToArray(_useWindupString5,1),textAnimated=_useWindupString6[0];var showing=subtitlesText!='';return/*#__PURE__*/_jsxs(\"div\",{id:\"emoji-and-bubble\",children:[showing&&/*#__PURE__*/_jsxs(\"span\",{className:\"speech-bubble\",children:[\" \",textAnimated,\" \"]}),showing&&/*#__PURE__*/_jsxs(\"div\",{id:\"emoji\",children:[\" \",emoji,\" \"]})]});};//COMPONENT: Capital letter of the game\nvar YourLetter=function YourLetter(props){// Shows the letter of the current game round \nvar letter=props.letter;return/*#__PURE__*/_jsx(\"div\",{children:letter?letter.toUpperCase():''});};//COMPONENT: Grey heart to be filled with pink, based on percentage\nvar HeartBar=function HeartBar(props){var maxScore=props.maxScore;var currentScore=props.currentScore>0?props.currentScore:'';var size=props.size;var percentage=currentScore?100*currentScore/maxScore:0;//add other props? eg, showScore={true/false}; showPercentage={true/false}\nvar y=24-24*percentage/100;//Height of the pink filling shape\n//Below: Heart-shaped vector graphs & text inside\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"ProgressBarH\",children:/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:size,height:size,viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsxs(\"defs\",{children:[/*#__PURE__*/_jsx(\"clipPath\",{id:\"cut-off-bottom\",children:/*#__PURE__*/_jsx(\"rect\",{x:\"0\",y:y,width:\"24\",height:\"24\"})}),/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"grey-grad\",x1:\"0%\",y1:\"0%\",x2:\"0%\",y2:\"100%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#cfccce\",stopOpacity:\"0.75\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"60%\",stopColor:\"#bab8ba\",stopOpacity:\"0.85\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"#949293\",stopOpacity:\"0.9\"})]}),/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"pink-grad\",x1:\"0%\",y1:\"0%\",x2:\"0%\",y2:\"100%\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"0%\",stopColor:\"#ff33a7\",stopOpacity:\"0.95\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"60%\",stopColor:\"#ff2667\",stopOpacity:\"0.95\"}),/*#__PURE__*/_jsx(\"stop\",{offset:\"100%\",stopColor:\"rgb(255,0,0)\",stopOpacity:\"0.95\"})]})]}),/*#__PURE__*/_jsx(\"path\",{style:{fill:\"url(#grey-grad)\"},d:\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"}),/*#__PURE__*/_jsx(\"path\",{style:{fill:\"url(#pink-grad)\"},d:\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\",clipPath:\"url(#cut-off-bottom)\"}),/*#__PURE__*/_jsx(\"text\",{textAnchor:\"middle\",x:\"12\",y:\"15\",color:\"white\",fontSize:\"11\",fill:\"white\",opacity:\"0.45\",style:{animation:\"wiggle 2.5s ease-out infinite\",animationDelay:'0.9s'},children:currentScore})]})});};var PopoverButtons=function PopoverButtons(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Tippy,{content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Har du problem med att spela? :\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"P\\xE5 grund av taligenk\\xE4nnarens begr\\xE4nsningar kan dessa hj\\xE4lpa till... \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"-Tala klart och i normal takt.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"-V\\xE4nta f\\xF6r katten att avsluta prata och b\\xF6rja lyssna p\\xE5 dig.\"]})]}),className:\"popover-box\",children:/*#__PURE__*/_jsx(\"button\",{className:\"round-button\",children:\"?\"})}),/*#__PURE__*/_jsx(Tippy,{content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"ABC Game\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Designades av: \",/*#__PURE__*/_jsx(\"br\",{}),\"Liao Hsien-hao Calvin\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"f\\xF6r kursprojektet av \",/*#__PURE__*/_jsx(\"strong\",{children:\"LT2216 Dialogue Systems\"}),\" p\\xE5 G\\xF6teborgs universitet.\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"github.com/chickenbror/ABCgame\"]})]}),className:\"popover-box\",children:/*#__PURE__*/_jsx(\"button\",{className:\"round-button\",children:\"i\"})})]});};","map":{"version":3,"sources":["C:/CodingProjects/ABCspelet/src/App.tsx"],"names":["React","Machine","assign","send","useMachine","asEffect","dmMachine","Confetti","TextLoop","useWindupString","HeadShake","require","RubberBand","Tippy","isChrome","isEdge","useSpeechSynthesis","useSpeechRecognition","machine","id","type","states","dm","asrtts","initial","idle","on","LISTEN","SPEAK","target","actions","_context","event","ttsAgenda","value","recognising","entry","exit","ASRRESULT","recResult","RECOGNISED","progress","match","speaking","ENDSPEECH","recLogResult","context","console","log","test","logIntent","nluData","intent","name","ReactiveButton","props","playingNow","state","maxHinted","hinted","maxSkipped","skipped","promptInGame","speakingText","promptMsg","matches","animation","stiffness","damping","spokentext","App","onEnd","speak","cancel","voices","onResult","result","listen","listening","stop","useState","voiceIndex","setVoiceIndex","voice","devTools","recStart","interimResults","continuous","lang","recStop","ttsStart","effect","text","ttsCancel","current","service","confettiSwitch","tally","letter","confettiConfig","angle","spread","startVelocity","elementCount","dragFriction","duration","stagger","width","height","perspective","colors","clicked","handleClick","YourSubtitles","emojis","emoji","subtitlesText","textAnimated","UserSubtitles","showing","YourLetter","toUpperCase","HeartBar","maxScore","currentScore","size","percentage","y","fill","animationDelay","PopoverButtons"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\n\r\n//XState library & Game DM-machine\r\nimport { Machine, assign, send, State } from \"xstate\";\r\nimport { useMachine, asEffect } from \"@xstate/react\";\r\nimport { dmMachine } from './dmGame';\r\n\r\n\r\n//Animation effects\r\nimport Confetti from 'react-dom-confetti';\r\nimport TextLoop from \"react-text-loop\";\r\nimport { useWindupString } from \"windups\";\r\n        // import HeadShake from 'react-reveal/HeadShake';\r\nconst HeadShake = require('react-reveal/HeadShake'); //?import shows error in TS, so use require() here instead\r\nconst RubberBand = require('react-reveal/RubberBand');\r\n\r\nimport Tippy from '@tippyjs/react';\r\n// import 'tippy.js/dist/tippy.css'; \r\n\r\n\r\n\r\n//Browser detection \r\nimport { isChrome, isEdge } from \"react-device-detect\";\r\n\r\n\r\n\r\n\r\n// import { inspect } from \"@xstate/inspect\";\r\n// inspect({ url:\"https://statecharts.io/inspect\", iframe: false });\r\n\r\n\r\n// State machines: ASR-TTS (voice interface) & dmGame\r\nimport { useSpeechSynthesis, useSpeechRecognition } from 'react-speech-kit';\r\n\r\n\r\nconst machine = Machine<SDSContext, any, SDSEvent>({\r\n    id: 'root',\r\n    type: 'parallel',\r\n    states: {\r\n        dm: {\r\n            ...dmMachine  //dmGame\r\n        },\r\n        asrtts: {\r\n            initial: 'idle',\r\n            states: {\r\n                idle: {\r\n                    on: {\r\n                        LISTEN: 'recognising',\r\n                        SPEAK: {\r\n                            target: 'speaking',\r\n                            actions: assign((_context, event) => { return { ttsAgenda: event.value } })\r\n                        }\r\n                    }\r\n                },\r\n                recognising: {\r\n                    initial: 'progress',\r\n                    entry: 'recStart',\r\n                    exit: 'recStop',\r\n                    on: {\r\n                        ASRRESULT: {\r\n                            actions: ['recLogResult',\r\n                                assign((_context, event) => { return { recResult: event.value } })],\r\n                            target: '.match'\r\n                        },\r\n                        RECOGNISED: 'idle'\r\n                    },\r\n                    states: {\r\n                        progress: {\r\n                        },\r\n                        match: {\r\n                            entry: send('RECOGNISED'),\r\n                        },\r\n                    }\r\n                },\r\n                speaking: {\r\n                    entry: 'ttsStart',\r\n                    on: {\r\n                        ENDSPEECH: 'idle',\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n},\r\n    {\r\n        actions: {\r\n            recLogResult: (context: SDSContext) => {\r\n                /* context.recResult = event.recResult; */\r\n                console.log('<< ASR: ' + context.recResult);\r\n\r\n            },\r\n            test: () => {\r\n                console.log('test')\r\n            },\r\n            logIntent: (context: SDSContext) => {\r\n                /* context.nluData = event.data */\r\n                console.log('<< NLU intent: ' + context.nluData.intent.name)\r\n            }\r\n        },\r\n    });\r\n\r\n\r\n\r\ninterface Props extends React.HTMLAttributes<HTMLElement> {\r\n    state: State<SDSContext, any, any, any>;  //==dm context >>access via props.state.context\r\n}\r\n//COMPONENT: Big button in the middle, with changing texts\r\nconst ReactiveButton = (props: Props,): JSX.Element => {\r\n    const {playingNow} = props.state.context\r\n    const {ttsAgenda} = props.state.context\r\n\r\n    const maxHinted = props.state.context.hinted >= 5\r\n\tconst maxSkipped = props.state.context.skipped >= 5\r\n\r\n    let promptInGame:string;\r\n    if(maxSkipped && maxHinted){promptInGame = '...eller s√§g Starta om, Sluta'}\r\n    else if(maxSkipped && !maxHinted){promptInGame = '...eller s√§g Tips, Starta om, Sluta'}\r\n    else if(!maxSkipped && maxHinted){promptInGame = '...eller s√§g Pass, Starta om, Sluta'}\r\n    else {promptInGame = '...eller s√§g Tips, Pass, Starta om, Sluta'}  //default\r\n\r\n    let speakingText= playingNow? 'üòº '+ttsAgenda : 'üòª '+ttsAgenda\r\n    let promptMsg = playingNow? promptInGame : \"...s√§g Ja eller Nej\"\r\n\r\n    switch (true) {\r\n        case props.state.matches({ asrtts: 'recognising' }):\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"glowing 20s linear\"}} {...props}>\r\n                    {/* Listening... */}\r\n\r\n                    <TextLoop mask={true} interval={5000} springConfig={{ stiffness: 170, damping: 8 }} >\r\n                        <div><code> {speakingText} </code></div>\r\n                        <div><code> {promptMsg} </code></div>\r\n                    </TextLoop>\r\n\r\n                </button>\r\n            );\r\n        case props.state.matches({ asrtts: 'speaking' }):\r\n            \r\n            const [spokentext] = useWindupString(speakingText); // adds char-by-char animation\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\"\r\n                    style={{ animation: \"bordering 1s infinite\" }} {...props}>\r\n                    {/* Speaking... */}\r\n                    <code>{spokentext}</code>\r\n                </button>\r\n            );\r\n        default:\r\n            return (\r\n                <button type=\"button\" className=\"glow-on-hover\" {...props}>\r\n                    <HeadShake>Spela nu!</HeadShake>\r\n                </button >\r\n            );\r\n    }\r\n}\r\n\r\n// //MAIN CONTAINER: React webpage elements & VOI\r\nexport default function App() {\r\n    \r\n\r\n    //Voice interface events (& console logs)\r\n    //Text to speech:\r\n    const { speak, cancel, speaking, voices } = useSpeechSynthesis({\r\n        onEnd: () => {send('ENDSPEECH') },\r\n    });\r\n\r\n    //Speech to text\r\n    const { listen, listening, stop } = useSpeechRecognition({\r\n        onResult: (result: any) => {send({ type: \"ASRRESULT\", value: result })  },\r\n    });\r\n\r\n    //List the supported synthesis-voices on the browswer:\r\n    const [voiceIndex, setVoiceIndex] = React.useState(null);\r\n    console.log(voices) //An array of available voices/languages ... varies depending on the computer/browser\r\n    const voice =  voices[2] || null; // voices[idx]? voices[idx] : null *(browser default voice) //chrome on Mac:2, edge:8 bengt, edgeDev:32 bengt \r\n\r\n    const [current, send, service] = useMachine(machine, {\r\n        devTools: true,\r\n        actions: {\r\n            recStart: asEffect(() => {\r\n                console.log('Ready to receive a voice input.');\r\n                listen({\r\n                    interimResults: false,\r\n                    continuous: true,\r\n                    lang: 'sv-SE'  //Config ASR input language here. //list of langs https://cloud.google.com/speech-to-text/docs/languages\r\n                });\r\n            }),\r\n            recStop: asEffect(() => {\r\n                console.log('Recognition stopped.');\r\n                stop()\r\n            }),\r\n            ttsStart: asEffect((context, effect) => {\r\n                console.log('Speaking...');\r\n                speak({ text: context.ttsAgenda\r\n                        , voice //Config of TTS output language/voice\r\n                     }) \r\n            }),\r\n            ttsCancel: asEffect((context, effect) => {\r\n                console.log('TTS STOP...');\r\n                cancel()\r\n            }),\r\n            speak: asEffect((context) => {\r\n\t            console.log('Speaking...');\r\n                speak({text: context.ttsAgenda })\r\n            }) \r\n        }\r\n    });\r\n\r\n    // dmMachine-context / React-states, to display on webpage or turn components on/off\r\n    const { confettiSwitch } = current.context; //triggers confetti when true\r\n    const { playingNow } = current.context;\r\n    const { tally } = current.context;\r\n    const { letter } = current.context;\r\n    \r\n    // Config for confetti \r\n    const confettiConfig = {\r\n        angle: 90,\r\n        spread: 360,\r\n        startVelocity: 80,\r\n        elementCount: 400,\r\n        dragFriction: 0.12,\r\n        duration: 7500,\r\n        stagger: 1,\r\n        width: \"7px\",\r\n        height: \"7px\",\r\n        perspective: \"210px\",\r\n        colors: [\"#a864fd\", \"#29cdff\", \"#78ff44\", \"#ff718d\", \"#fdff6a\"]\r\n      };\r\n    \r\n    let clicked=0;\r\n    const handleClick = () =>{ \r\n        if(clicked===0){ console.log(\"clicked\"); send('CLICK'); clicked=1 }\r\n        else{ console.log(\"unclicked\"); send('UNCLICK'); clicked=0 }\r\n    }\r\n\r\n    //>>>JSX codes & various components\r\n    \r\n    // Alt page: Show if not using Chrome or Edge\r\n    if(!isChrome && !isEdge)\r\n    return (\r\n        <div className='OtherBrowsers'>  \r\n            <HeadShake>\r\n            <div className='Box'>   \r\n                <h1>Din webbl√§sare st√∂der inte taligenk√§nning ü•≤ </h1>\r\n                <p>Anv√§nd ist√§llet Chrome eller Edge :-)</p>\r\n            </div>\r\n            </HeadShake>\r\n        </div>\r\n      )\r\n\r\n    //Show if using Chrome or Edge\r\n    return (\r\n        <div className='main'>\r\n            <div className=\"PopoverButtons\"> <PopoverButtons/> </div>\r\n            <div className=\"App\">\r\n                \r\n                <div className=\"LetterAndHeart\">\r\n                    <div className=\"GlowLetter\"> <YourLetter letter={letter}/> </div>\r\n                    <div className=\"Heart\"> \r\n                        {playingNow && <HeartBar currentScore={tally} maxScore={5} size={50} />  }\r\n                    </div> \r\n                </div>\r\n                \r\n                <Confetti active={ confettiSwitch } config={ confettiConfig }/> \r\n\r\n                <RubberBand>\r\n                    <div className=\"Button\"> \r\n                        <ReactiveButton state={current} onClick={() => {handleClick()}} /> \r\n                    </div>\r\n                </RubberBand>\r\n\r\n                <div className=\"Subtitles\"> \r\n                    {/* VersionA: FOR Github deployment & Canvas submission */}\r\n                    {/* <YourSubtitles state={current}/>  */}\r\n\r\n                    {/* Version B: FOR demo (on local cuz it cannot show on Github page) */}\r\n                    <UserSubtitles state={current}/> \r\n                </div>\r\n            \r\n            </div>\r\n\r\n        </div>\r\n    )\r\n};\r\n\r\n//COMPONENT: Displaying input of voice interface (ie, recResult)\r\nconst YourSubtitles=(props:Props) =>{\r\n    // Player's speech-- only displays when recResult!=undefined \r\n\r\n    const {tally} = props.state.context\r\n    const {recResult} = props.state.context\r\n    //Prefix face changes based on score of the game\r\n    const  emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥']\r\n    let emoji=tally? emojis[tally]:'üôÉ'\r\n\r\n    let subtitlesText:string;\r\n    if(props.state.matches({ asrtts: 'recognising' })){\r\n        subtitlesText=emoji+' Lyssnar nu p√• dig...'\r\n    }else if(recResult && recResult!=''){\r\n        subtitlesText = emoji+' '+recResult\r\n    }else{\r\n        subtitlesText = ''\r\n    }\r\n\r\n    const [textAnimated] = useWindupString(subtitlesText);\r\n    return(\r\n        <div>\r\n            <span> {textAnimated} </span>\r\n        </div>\r\n    )\r\n}\r\n\r\n//This one doesn't show on Github pages...? but can run locally and use for presentation demo\r\nconst UserSubtitles=(props:Props) =>{\r\n\r\n    const {tally} = props.state.context\r\n    const {recResult} = props.state.context\r\n    // const recResult='testing text'\r\n\r\n    const  emojis=['üòó','üôÇ','üòÄ','üòÑ','üòÅ','ü•≥']\r\n    let emoji= tally? emojis[tally]:'üôÉ'\r\n\r\n    // const defaultText = props.state.matches({ asrtts: 'recognising' })? 'Listening...' : ''\r\n    // const subtitlesText = recResult? recResult : defaultText\r\n\r\n    let subtitlesText:string;\r\n    if(props.state.matches({ asrtts: 'recognising' })){\r\n        subtitlesText='Lyssnar nu p√• dig...'\r\n    }else if(recResult && recResult!=''){\r\n        subtitlesText = recResult\r\n    }else{\r\n        subtitlesText = ''\r\n    }\r\n\r\n    const [textAnimated] = useWindupString(subtitlesText);\r\n    const showing = subtitlesText!=''\r\n    return(\r\n        <div id='emoji-and-bubble'>\r\n            {showing &&  <span className='speech-bubble'> {textAnimated} </span> }\r\n            {showing && <div id='emoji'> {emoji} </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\n//COMPONENT: Capital letter of the game\r\nconst YourLetter=(props:any) =>{\r\n    // Shows the letter of the current game round \r\n    const letter = props.letter\r\n    return(\r\n        <div> \r\n            {letter? letter.toUpperCase():''}\r\n        </div> \r\n    )\r\n}\r\n\r\n//COMPONENT: Grey heart to be filled with pink, based on percentage\r\nconst HeartBar = (props:any) => {\r\n    \r\n    const maxScore = props.maxScore\r\n    const currentScore = props.currentScore>0? props.currentScore : ''\r\n    const size = props.size\r\n    const percentage = currentScore? 100*currentScore/maxScore : 0\r\n    //add other props? eg, showScore={true/false}; showPercentage={true/false}\r\n\r\n\r\n    const y = 24 - (24 * percentage) / 100; //Height of the pink filling shape\r\n\r\n    //Below: Heart-shaped vector graphs & text inside\r\n    return (\r\n      <div className=\"ProgressBarH\">\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={size}\r\n          height={size}\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <defs>\r\n            <clipPath id=\"cut-off-bottom\">\r\n              <rect x=\"0\" y={y} width=\"24\" height=\"24\" />\r\n            </clipPath>\r\n          \r\n            <linearGradient id=\"grey-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                <stop offset=\"0%\" stopColor=\"#cfccce\" stopOpacity=\"0.75\" />\r\n                <stop offset=\"60%\" stopColor=\"#bab8ba\" stopOpacity=\"0.85\" />\r\n                <stop offset=\"100%\" stopColor=\"#949293\" stopOpacity=\"0.9\" />\r\n            </linearGradient>\r\n\r\n            <linearGradient id=\"pink-grad\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                <stop offset=\"0%\" stopColor=\"#ff33a7\" stopOpacity=\"0.95\" />\r\n                <stop offset=\"60%\" stopColor=\"#ff2667\" stopOpacity=\"0.95\" />\r\n                <stop offset=\"100%\" stopColor=\"rgb(255,0,0)\" stopOpacity=\"0.95\" />\r\n            </linearGradient>\r\n\r\n          </defs>\r\n          \r\n          <path\r\n            style={{ fill: \"url(#grey-grad)\" }}\r\n            d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"\r\n            />\r\n\r\n          <path\r\n            style={{ fill: \"url(#pink-grad)\", }}\r\n            d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"\r\n            clipPath=\"url(#cut-off-bottom)\"\r\n            />\r\n\r\n          <text textAnchor=\"middle\" x=\"12\" y=\"15\" color=\"white\" fontSize=\"11\" fill=\"white\" opacity=\"0.45\"\r\n                style={{animation: \"wiggle 2.5s ease-out infinite\", animationDelay:'0.9s'}}>\r\n            {currentScore} \r\n          </text>\r\n\r\n        </svg>\r\n      </div>\r\n    );\r\n  };\r\n\r\nconst PopoverButtons = () => {\r\n\r\n\r\n    return (\r\n        <div>\r\n\r\n            <Tippy content={\r\n                <div>\r\n                <h4>Har du problem med att spela? :</h4>\r\n            \r\n                    <p>\r\n                    P√• grund av taligenk√§nnarens begr√§nsningar kan dessa hj√§lpa till... <br></br><br></br>\r\n                    -Tala klart och i normal takt.<br></br><br></br>\r\n                    -V√§nta f√∂r katten att avsluta prata och b√∂rja lyssna p√• dig.\r\n                    </p>\r\n                </div>\r\n            } className=\"popover-box\">\r\n                <button className=\"round-button\">?</button>\r\n            </Tippy>\r\n\r\n            <Tippy content={\r\n                    <div>\r\n                    <h4>ABC Game</h4>\r\n                        <p>\r\n                        Designades av: <br></br>\r\n                        Liao Hsien-hao Calvin<br></br>\r\n                        <br></br>\r\n                        f√∂r kursprojektet av <strong>LT2216 Dialogue Systems</strong> p√• G√∂teborgs universitet.\r\n                        <br></br><br></br>\r\n                        github.com/chickenbror/ABCgame\r\n                        </p>\r\n                    </div>\r\n            }  className=\"popover-box\">\r\n                <button className=\"round-button\">i</button>\r\n            </Tippy>\r\n\r\n\r\n        </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}