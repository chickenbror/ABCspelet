{"ast":null,"code":"import _objectSpread from \"C:/CodingProjects/ABCspelet/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { send } from \"xstate\"; // SRGS parser and example (logs the results to console on page load)\n\nimport { loadGrammar } from './runparser';\nimport { parse } from './chartparser';\nimport { grammar } from './grammars/pizzaGrammar';\nvar gram = loadGrammar(grammar);\nvar input = \"I would like a coca cola and three large pizzas with pepperoni and mushrooms\";\nvar prs = parse(input.split(/\\s+/), gram);\nvar result = prs.resultsForRule(gram.$root)[0];\nconsole.log(result);\nvar sayColour = send(function (context) {\n  return {\n    type: \"SPEAK\",\n    value: \"Repainting to \".concat(context.recResult)\n  };\n});\n\nfunction say(text) {\n  return send(function (_context) {\n    return {\n      type: \"SPEAK\",\n      value: text\n    };\n  });\n}\n\nfunction promptAndAsk(prompt) {\n  return {\n    initial: 'prompt',\n    states: {\n      prompt: {\n        entry: say(prompt),\n        on: {\n          ENDSPEECH: 'ask'\n        }\n      },\n      ask: {\n        entry: send('LISTEN')\n      }\n    }\n  };\n}\n\nexport var dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'welcome'\n      }\n    },\n    welcome: _objectSpread({\n      on: {\n        RECOGNISED: [{\n          target: 'stop',\n          cond: function cond(context) {\n            return context.recResult === 'stop';\n          }\n        }, {\n          target: 'repaint'\n        }]\n      }\n    }, promptAndAsk(\"Tell me the colour\")),\n    stop: {\n      entry: say(\"Ok\"),\n      always: 'init'\n    },\n    repaint: {\n      initial: 'prompt',\n      states: {\n        prompt: {\n          entry: sayColour,\n          on: {\n            ENDSPEECH: 'repaint'\n          }\n        },\n        repaint: {\n          entry: 'changeColour',\n          always: '#root.dm.welcome'\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/CodingProjects/ABCspelet/src/dmColourChanger.ts"],"names":["send","loadGrammar","parse","grammar","gram","input","prs","split","result","resultsForRule","$root","console","log","sayColour","context","type","value","recResult","say","text","_context","promptAndAsk","prompt","initial","states","entry","on","ENDSPEECH","ask","dmMachine","init","CLICK","welcome","RECOGNISED","target","cond","stop","always","repaint"],"mappings":";AAAA,SAAwBA,IAAxB,QAA4C,QAA5C,C,CAEA;;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,SAASC,OAAT,QAAwB,yBAAxB;AAEA,IAAMC,IAAI,GAAGH,WAAW,CAACE,OAAD,CAAxB;AACA,IAAME,KAAK,GAAG,8EAAd;AACA,IAAMC,GAAG,GAAGJ,KAAK,CAACG,KAAK,CAACE,KAAN,CAAY,KAAZ,CAAD,EAAqBH,IAArB,CAAjB;AACA,IAAMI,MAAM,GAAGF,GAAG,CAACG,cAAJ,CAAmBL,IAAI,CAACM,KAAxB,EAA+B,CAA/B,CAAf;AAEAC,OAAO,CAACC,GAAR,CAAYJ,MAAZ;AAEA,IAAMK,SAAuC,GAAGb,IAAI,CAAC,UAACc,OAAD;AAAA,SAA0B;AAC3EC,IAAAA,IAAI,EAAE,OADqE;AAC5DC,IAAAA,KAAK,0BAAmBF,OAAO,CAACG,SAA3B;AADuD,GAA1B;AAAA,CAAD,CAApD;;AAIA,SAASC,GAAT,CAAaC,IAAb,EAAyD;AACrD,SAAOnB,IAAI,CAAC,UAACoB,QAAD;AAAA,WAA2B;AAAEL,MAAAA,IAAI,EAAE,OAAR;AAAiBC,MAAAA,KAAK,EAAEG;AAAxB,KAA3B;AAAA,GAAD,CAAX;AACH;;AAED,SAASE,YAAT,CAAsBC,MAAtB,EAAgF;AAC5E,SAAQ;AACJC,IAAAA,OAAO,EAAE,QADL;AAEJC,IAAAA,MAAM,EAAE;AACJF,MAAAA,MAAM,EAAE;AACJG,QAAAA,KAAK,EAAEP,GAAG,CAACI,MAAD,CADN;AAEJI,QAAAA,EAAE,EAAE;AAAEC,UAAAA,SAAS,EAAE;AAAb;AAFA,OADJ;AAKJC,MAAAA,GAAG,EAAE;AACDH,QAAAA,KAAK,EAAEzB,IAAI,CAAC,QAAD;AADV;AALD;AAFJ,GAAR;AAYH;;AAGD,OAAO,IAAM6B,SAAmD,GAAI;AAChEN,EAAAA,OAAO,EAAE,MADuD;AAEhEC,EAAAA,MAAM,EAAE;AACJM,IAAAA,IAAI,EAAE;AACFJ,MAAAA,EAAE,EAAE;AACAK,QAAAA,KAAK,EAAE;AADP;AADF,KADF;AAMJC,IAAAA,OAAO;AACHN,MAAAA,EAAE,EAAE;AACAO,QAAAA,UAAU,EAAE,CACR;AAAEC,UAAAA,MAAM,EAAE,MAAV;AAAkBC,UAAAA,IAAI,EAAE,cAACrB,OAAD;AAAA,mBAAaA,OAAO,CAACG,SAAR,KAAsB,MAAnC;AAAA;AAAxB,SADQ,EAER;AAAEiB,UAAAA,MAAM,EAAE;AAAV,SAFQ;AADZ;AADD,OAMAb,YAAY,CAAC,oBAAD,CANZ,CANH;AAcJe,IAAAA,IAAI,EAAE;AACFX,MAAAA,KAAK,EAAEP,GAAG,CAAC,IAAD,CADR;AAEFmB,MAAAA,MAAM,EAAE;AAFN,KAdF;AAkBJC,IAAAA,OAAO,EAAE;AACLf,MAAAA,OAAO,EAAE,QADJ;AAELC,MAAAA,MAAM,EAAE;AACJF,QAAAA,MAAM,EAAE;AACJG,UAAAA,KAAK,EAAEZ,SADH;AAEJa,UAAAA,EAAE,EAAE;AAAEC,YAAAA,SAAS,EAAE;AAAb;AAFA,SADJ;AAKJW,QAAAA,OAAO,EAAE;AACLb,UAAAA,KAAK,EAAE,cADF;AAELY,UAAAA,MAAM,EAAE;AAFH;AALL;AAFH;AAlBL;AAFwD,CAA7D","sourcesContent":["import { MachineConfig, send, Action } from \"xstate\";\n\n// SRGS parser and example (logs the results to console on page load)\nimport { loadGrammar } from './runparser'\nimport { parse } from './chartparser'\nimport { grammar } from './grammars/pizzaGrammar'\n\nconst gram = loadGrammar(grammar)\nconst input = \"I would like a coca cola and three large pizzas with pepperoni and mushrooms\"\nconst prs = parse(input.split(/\\s+/), gram)\nconst result = prs.resultsForRule(gram.$root)[0]\n\nconsole.log(result)\n\nconst sayColour: Action<SDSContext, SDSEvent> = send((context: SDSContext) => ({\n    type: \"SPEAK\", value: `Repainting to ${context.recResult}`\n}))\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction promptAndAsk(prompt: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: 'prompt',\n        states: {\n            prompt: {\n                entry: say(prompt),\n                on: { ENDSPEECH: 'ask' }\n            },\n            ask: {\n                entry: send('LISTEN'),\n            },\n        }\n    })\n}\n\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            on: {\n                RECOGNISED: [\n                    { target: 'stop', cond: (context) => context.recResult === 'stop' },\n                    { target: 'repaint' }]\n            },\n            ...promptAndAsk(\"Tell me the colour\")\n        },\n        stop: {\n            entry: say(\"Ok\"),\n            always: 'init'\n        },\n        repaint: {\n            initial: 'prompt',\n            states: {\n                prompt: {\n                    entry: sayColour,\n                    on: { ENDSPEECH: 'repaint' }\n                },\n                repaint: {\n                    entry: 'changeColour',\n                    always: '#root.dm.welcome'\n                }\n            }\n        }\n    }\n})\n"]},"metadata":{},"sourceType":"module"}